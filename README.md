# EDA自動化アプリ

データサイエンスチーム向けの探索的データ分析（EDA）自動化ツールです。CSVやExcelファイルをアップロードするだけで、包括的なデータ分析レポートを自動生成します。

## 🚀 主な機能

- **基本統計**: データ概要、基本統計量、欠損値・重複値チェック
- **分布分析**: ヒストグラム、箱ひげ図、外れ値検出
- **相関分析**: 相関行列、散布図マトリックス、ヒートマップ
- **時系列分析**: 時系列プロット、トレンド分析
- **前処理機能**: 欠損値処理、外れ値除去、データ型変換
- **レポート生成**: PDF形式での包括的な分析レポート

## 📋 システム要件

- Windows 11
- Python 3.8以上
- メモリ: 32GB推奨
- 空きディスク容量: 3GB以上

## 🔧 セットアップ手順

### 1. Pythonのインストール（未インストールの場合）

1. [Python公式サイト](https://www.python.org/downloads/)から最新版をダウンロード
2. インストール時に「Add Python to PATH」にチェックを入れる
3. インストール完了後、コマンドプロンプトで確認:
```cmd
python --version
```

### 2. アプリケーションのダウンロード

1. このリポジトリをダウンロードまたはクローン
```bash
git clone [リポジトリURL]
cd eda-automation-app
```

### 3. 初期セットアップ

1. `setup.bat` をダブルクリックして実行
2. 初回実行時は数分かかります（仮想環境の作成と依存関係のインストール）
3. 以下のメッセージが表示されたら成功です：
```
セットアップ完了！
仮想環境が作成され、依存関係がインストールされました。
```

### 4. アプリケーションの起動

1. `run.bat` をダブルクリックして実行
2. 以下のメッセージが表示されます：
```
アプリケーションを起動中...
ブラウザで以下のURLにアクセスしてください:
   http://localhost:8501
```

3. ブラウザで `http://localhost:8501` にアクセス
4. EDA自動化アプリが表示されます

### 5. アプリケーションの停止

- コマンドプロンプトで `Ctrl+C` を押す
- または、コマンドプロンプトのウィンドウを閉じる

## 📝 使い方

### 基本的な流れ

1. **データアップロード**
   - CSVまたはExcelファイルを選択
   - 最大ファイルサイズ: 3GB

2. **データ読み込み**
   - "データを読み込む"ボタンをクリック
   - データプレビューで内容を確認

3. **分析開始**
   - "分析を開始する"ボタンをクリック
   - 左のサイドバーから各分析ページにアクセス

4. **結果確認**
   - 各分析ページで結果を確認
   - 必要に応じてPDFレポートをダウンロード

### 対応ファイル形式

- **CSV**: カンマ区切り、タブ区切り、セミコロン区切り
- **Excel**: .xlsx, .xls形式
- **文字エンコーディング**: 自動判定（UTF-8, Shift-JIS, CP932等）

### 各分析ページの説明

#### 📊 基本統計
- データ形状（行数、列数、メモリ使用量）
- データ型別統計
- 欠損値・重複値の詳細分析
- 数値列・カテゴリ列の基本統計量

#### 📈 分布分析
- **数値列**: ヒストグラム、箱ひげ図、Q-Qプロット、密度プロット
- **カテゴリ列**: 棒グラフ、円グラフ、頻度統計
- **外れ値検出**: IQR法、Z-score法、修正Z-score法
- **インタラクティブプロット**: Plotly による動的可視化

#### 🔗 相関分析
- 数値列間の相関行列
- 相関ヒートマップ
- 散布図マトリックス
- 強い相関の自動検出

#### ⏰ 時系列分析
- 日付カラムの手動指定
- 時系列プロット
- 基本的なトレンド分析

#### 🔧 前処理
- **欠損値処理**: 削除、平均値補完、中央値補完、最頻値補完、前方/後方補完
- **外れ値処理**: IQR法、Z-score法、修正Z-score法による除去
- **データ型変換**: 自動・手動でのデータ型変換
- **処理結果のダウンロード**: 前処理済みデータのCSVダウンロード

## ⚙️ 設定のカスタマイズ

`config/settings.yaml` ファイルで各種設定をカスタマイズできます：

### 主要な設定項目GB推奨
- 空きディスク容量: 5GB以上

## 🔧 セットアップ手順

### 1. Docker Desktopのインストール

1. [Docker Desktop](https://www.docker.com/products/docker-desktop/)をダウンロード
2. インストール後、Docker Desktopを起動
3. Docker Desktopが正常に動作していることを確認

### 2. アプリケーションのダウンロード

1. このリポジトリをダウンロードまたはクローン
```bash
git clone [リポジトリURL]
cd eda-automation-app
```

### 3. アプリケーションの起動

1. `setup.bat` をダブルクリックして実行
2. 初回実行時は数分かかります（Dockerイメージのビルド）
3. 以下のメッセージが表示されたら成功です：
```
セットアップ完了！
アプリケーションが起動しました。
ブラウザで以下のURLにアクセスしてください:
   http://localhost:8501
```

### 4. アプリケーションへのアクセス

1. ブラウザで `http://localhost:8501` にアクセス
2. EDA自動化アプリが表示されます

## 📝 使い方

### 基本的な流れ

1. **データアップロード**
   - CSVまたはExcelファイルを選択
   - 最大ファイルサイズ: 3GB

2. **データ読み込み**
   - "データを読み込む"ボタンをクリック
   - データプレビューで内容を確認

3. **分析開始**
   - "分析を開始する"ボタンをクリック
   - 左のサイドバーから各分析ページにアクセス

4. **結果確認**
   - 各分析ページで結果を確認
   - 必要に応じてPDFレポートをダウンロード

### 対応ファイル形式

- **CSV**: カンマ区切り、タブ区切り、セミコロン区切り
- **Excel**: .xlsx, .xls形式
- **文字エンコーディング**: 自動判定（UTF-8, Shift-JIS, CP932等）

### 各分析ページの説明

#### 📊 基本統計
- データ形状（行数、列数、メモリ使用量）
- データ型別統計
- 欠損値・重複値の詳細分析
- 数値列・カテゴリ列の基本統計量

#### 📈 分布分析
- **数値列**: ヒストグラム、箱ひげ図、Q-Qプロット、密度プロット
- **カテゴリ列**: 棒グラフ、円グラフ、頻度統計
- **外れ値検出**: IQR法、Z-score法、修正Z-score法
- **インタラクティブプロット**: Plotly による動的可視化

#### 🔗 相関分析
- 数値列間の相関行列
- 相関ヒートマップ
- 散布図マトリックス
- 強い相関の自動検出

#### ⏰ 時系列分析
- 日付カラムの手動指定
- 時系列プロット
- 基本的なトレンド分析

#### 🔧 前処理
- **欠損値処理**: 削除、平均値補完、中央値補完、最頻値補完、前方/後方補完
- **外れ値処理**: IQR法、Z-score法、修正Z-score法による除去
- **データ型変換**: 自動・手動でのデータ型変換
- **処理結果のダウンロード**: 前処理済みデータのCSVダウンロード

## ⚙️ 設定のカスタマイズ

`config/settings.yaml` ファイルで各種設定をカスタマイズできます：

### 主要な設定項目

```yaml
general:
  max_file_size_mb: 3000      # 最大ファイルサイズ（MB）
  max_memory_usage_gb: 16     # 最大メモリ使用量（GB）
  timeout_seconds: 120        # 処理タイムアウト（秒）

analysis:
  basic_stats: true           # 基本統計の有効/無効
  distribution: true          # 分布分析の有効/無効
  correlation: true           # 相関分析の有効/無効
  timeseries: true           # 時系列分析の有効/無効
  preprocessing: true         # 前処理機能の有効/無効

visualization:
  max_categories: 20          # カテゴリ変数の最大表示数
  color_palette: "husl"       # カラーパレット
```

### 設定変更の手順

1. `config/settings.yaml` をテキストエディタで開く
2. 必要な設定を変更
3. ファイルを保存
4. アプリケーションを再起動（`Ctrl+C` → `run.bat`）

## 🛠️ トラブルシューティング

### よくある問題と解決方法

#### 1. Pythonが見つからない
```
エラー: Pythonがインストールされていません
```
**解決方法:**
- Python 3.8以上をインストール
- インストール時に「Add Python to PATH」にチェック
- コマンドプロンプトを再起動してから再実行

#### 2. 仮想環境の作成に失敗
```
エラー: 仮想環境の作成に失敗しました
```
**解決方法:**
- 管理者権限でコマンドプロンプトを起動
- ウイルス対策ソフトが妨害していないか確認
- 十分な空きディスク容量があるか確認

#### 3. 依存関係のインストールに失敗
```
エラー: 依存関係のインストールに失敗しました
```
**解決方法:**
- インターネット接続を確認
- 企業ファイアウォールがある場合、IT部門に相談
- プロキシ設定が必要な場合は設定を追加

#### 4. ポート8501が使用中
```
Port 8501 is already in use
```
**解決方法:**
- 他のStreamlitアプリが起動していないか確認
- `Ctrl+C` でアプリを停止してから再起動
- 必要に応じてPCを再起動

#### 5. メモリ不足エラー
```
Memory error during analysis
```
**解決方法:**
- より小さなファイルで試す
- `config/settings.yaml` で `max_memory_usage_gb` を調整
- 不要なアプリケーションを終了してメモリを確保

#### 6. ファイル読み込みエラー
```
ファイル読み込みエラー: [詳細]
```
**解決方法:**
- ファイル形式がCSVまたはExcelか確認
- ファイルが破損していないか確認
- ファイルサイズが上限以下か確認
- 文字エンコーディングに問題がないか確認

#### 7. 日本語文字化け
**解決方法:**
- CSVファイルの場合、UTF-8またはShift-JISで保存
- Excelファイルの場合、最新の形式（.xlsx）で保存

## 🔄 日常的な使用方法

### 起動手順
1. `run.bat` をダブルクリック
2. ブラウザで `http://localhost:8501` にアクセス

### 停止手順
1. コマンドプロンプトで `Ctrl+C` を押す
2. コマンドプロンプトウィンドウを閉じる

### 再セットアップが必要な場合
- 新しい依存関係を追加した場合
- 仮想環境が破損した場合
```bash
setup.bat  # 仮想環境を再作成
```

## 📊 パフォーマンス最適化

### 推奨設定

#### 大容量データ（1GB以上）の場合
- メモリ使用量上限を調整: `max_memory_usage_gb: 24`
- タイムアウト時間を延長: `timeout_seconds: 300`
- 分析機能を必要なもののみ有効化

#### 高速分析が必要な場合
- 基本統計と分布分析のみ有効化
- カテゴリ表示数を制限: `max_categories: 10`

### メモリ使用量の監視
- Windowsタスクマネージャーで監視
- Python.exeプロセスのメモリ使用量を確認

## 🔒 セキュリティ

### データ保護
- アップロードされたデータはメモリ上でのみ処理
- ブラウザを閉じるとデータは自動削除
- ローカル環境でのみ動作（外部送信なし）
- 仮想環境により本体のPython環境を保護

### 注意事項
- 機密データを扱う場合は、作業後に必ずアプリケーションを停止
- 共有PCでの使用時は、ブラウザの履歴とキャッシュをクリア
- `venv/` フォルダは削除してもセットアップで再作成可能

## 🆕 機能追加・改修

### 開発環境のセットアップ
```bash
# リポジトリをクローン
git clone [リポジトリURL]
cd eda-automation-app

# セットアップスクリプトを実行
setup.bat

# 開発モードで起動
run.bat
```

### コンポーネント構成
```
app/
├── main.py                 # メインアプリ
├── components/             # 機能コンポーネント
│   ├── file_handler.py     # ファイル処理
│   ├── basic_stats.py      # 基本統計
│   ├── visualization.py    # 可視化
│   ├── correlation.py      # 相関分析
│   ├── timeseries.py       # 時系列分析
│   └── preprocessor.py     # 前処理
├── pages/                  # Streamlitページ
└── utils/                  # ユーティリティ
```

### 新機能追加の流れ
1. `components/` に新しいクラスを作成
2. `pages/` に対応するページを作成
3. `config/settings.yaml` に設定項目を追加
4. テスト実行
5. ドキュメント更新

### 仮想環境の管理
```bash
# 仮想環境のアクティベート（手動の場合）
venv\Scripts\activate

# 新しいパッケージの追加
pip install [パッケージ名]
pip freeze > requirements.txt

# 仮想環境のディアクティベート
deactivate
```

## 📞 サポート

### 改修依頼・バグ報告
- データサイエンスチーム内で共有
- 月1回の定期レビューで対応

### ログの確認
- コマンドプロンプトでエラーメッセージを確認
- Streamlitのログは画面に表示される

### バックアップ
- `config/settings.yaml` のバックアップを推奨
- カスタマイズした設定を保存

## 💡 Tips

### 効率的な使用方法
1. **設定をカスタマイズ**: 不要な分析機能を無効化して高速化
2. **ファイル形式の選択**: 大容量データはParquet形式を検討（今後対応予定）
3. **分析の順序**: 基本統計→分布分析→相関分析の順で確認

### よく使用する設定
```yaml
# 高速分析用設定
analysis:
  basic_stats: true
  distribution: true
  correlation: false
  timeseries: false
  preprocessing: false

# 大容量データ用設定
general:
  max_file_size_mb: 5000
  max_memory_usage_gb: 24
  timeout_seconds: 300
```

## 📄 ライセンス

社内利用のみ。外部配布禁止。

---

**EDA自動化アプリ v2.0 (venv版)**  
*データサイエンスチーム*